Mikä? Kotitehtävä palvelinten hallinta -kurssille.

Virtuaalikoneen ajo Oracle VM Virtualboxissa Lenovo IdeaPad 1 14" R5-7520U:lla läppärillä.
Kotitehtävä 1: Viisikko

x) Lue ja tiivistä.

### Two Machine Virtual Network With Debian 11 Bullseye and Vagrant.

Vagrantilla voi automaattisesti asentaa Virtualboxiin virtuaalikoneita, joissa on automaattinen Secure Shell kirjautuminen, eikä tarvetta käyttäjän graafiselle käyttöliittymälle ole.

Asennus tapahtuu seuraavasti: 

`sudo apt-get update`
`sudo apt-get install vagrant virtualbox`

Vagrant tiedoston tekeminen

Uusi hakemisto projektille ja sinne tiedosto nimeltä Vagrantfile, tiedostoon seuraava teksti

`mkdir twohost/; cd twohost/`
`nano Vagrantfile`

Kirjautuminen ja uloskirjautuminen

`vagrant ssh t001`
`exit`

Hajottaminen
`vagrant destroy`

Uudet koneet samoilla säännöillä: 
`vagrant up`

(Karvinen. 2021)


### Salt Quickstart – Salt Stack Master and Slave on Ubuntu Linux

Ladataan sekä konfiguroidaan master ja minion.

Masterin lataus

- `sudo apt-get -y install salt-master`
- IP-osoitteen selvitys: `hostname -i`

Minionin lataus

- `sudo apt-get update`
- `sudo apt-get -y install salt-minion`

Minionin pitää tietää missä master on ja jokaisella slavella tulee olla uniikki ID.

- `sudoedit /etc/saltminion`
- master: IP-osoite
- id: valitsemasi id

Minion tulee uudelleenkäynnistää, jotta muutokset tulevat voimaan.

- `sudo systemctl restart salt-minion.service`

Ennenkuin master voi kontrolloida minionia, sen tulee hyväksen tunnisteavain.

- `sudo salt-key -A`

Minionin hallinta

- Yhteyden tarkistus: `sudo salt '*' cmd.run whoami`
- Minionin IP-osoitteet: `master$ sudo salt '*' cmd.run 'hostname -I`

(Karvinen. 2018.)

### Hello Salt Infra-as-Code

Salt and micro editor lataus

`sudo apt-get update`
`sudo apt-get -y install salt-minion micro`
`export EDITOR=micro`

Hakemisto hello moduulille
`sudo mkdir -p /srv/salt/hello`
`cd /srv/salt/hello`

Kirjoitetaan infraa koodina

`sudoedit init.sls`

`tmp/hellotero:
  file.managed`

Ajetaan

`sudo salt-call --local state.apply hello`

Tarkistetaan

`ls /tmp/hellotero`
/tmp/hellotero, jos toimii

(Karvinen. 2014)

### Salt Vagrant - automatically provision one master and two slaves

Infra as Code - Your wishes as a text file

Haluttu koodi kansioon /srv/salt/kansio

`sudo mkdir -p /srv/salt/hello`

kansioon tiedosto init.sls

`sudoedit /srv/salt/hello/init.sls`

tiedostoon YAML syntaxilla, sisännys kahdella välilyönnillä

`/tmp/infra-as-code:
  file.managed`

ajaminen

`sudo salt '*' state.apply hello`

top.sls - What Slave Runs What States

top.sls tiedosto määrittää mitkä minionit ajavat mitkäkin tilat. 

`sudo salt '*' state.apply hello`

`sudoedit /srv/salt/top.sls`

teksti sinne

`/srv/salt/top.sls
base:
  '*':
    - hello`

(Karvinen. 2023)

###Salt contributor: Salt overview

YAML:n säännöt

YAML on merkintäkieli.
* Data kirjoitetaan avain: arvo -pareissa.
* Avainten arvo voi olla monissa eri rakenteissa. 
* Kaikki on kirjainlyöntikohtaisista. 
* Kommentit alkavat hashilla #.

YAML yksinkertaiset rakenteet

1. Skalaarit:

avain:arvo -kartoitukset missä arvo voi olla numero, merkkijono tai totuusarvomuuttuja.

#avain: arvo

vihannekset: herneet

hedelmä: omenat

jyvät: leipä

2. Listat

avain: seurattuna lista arvoista, missä jokainen arvo on erillisellä rivillä ja seuraa kaksi välilyöntiä ja kaksoispiste.

#järjestysavain: 
  - arvo1
  - arvo2

vihannekset:
  - herneet
  - porkkanat
hedelmät:
  - omenat
  - appelsiinit

3. Hakemisto

Kokoelma avain:arvo kartoituksia ja listoja.

lounas:

  alkupala: katkarapu cocktail
  
  juoma: kupliva vesi
  
  pääruoka:
  
    - pihvi
    
    - perunamuussi
    
    - päivällisrulla
    
  jälkiruoka:
  
    - suklaakakku

Listat ja hakemistot - YAML:n lohkorakenne

* YAML on organisoitu lohkorakenteisiin.
* Sisennys asettaa kontekstin. Sinun täytyy sisentää omaisuudet yhdellä tai useammalla väliyönnillä, mutta kaksi välilyöntiä on standardi.
* Kokoelma, mikä on lista tai hakemiston lohkorakenne, ilmaisee jokaisen rivin väliviivalla ja välilyönnillä ("- "). 

(Salt overview. 2021-2024.)




### Lähteet




https://docs.saltproject.io/salt/user-guide/en/latest/topics/overview.html#rules-of-yaml








